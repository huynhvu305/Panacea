<section class="p-4">
  <!-- ===== HEADER ===== -->
  <div class="d-flex align-items-center justify-content-between mb-3 header-bar">
    <div class="d-flex align-items-center">
      <i class="bi bi-box-arrow-left" style="cursor: pointer; font-size: 1.05rem; margin-right: 0.75rem"
        (click)="navigateBack()"></i>
      <div>
        <div class="h-100 d-flex align-items-center">
          <h2 class="m-0">ƒê·∫∑t ph√≤ng</h2>
        </div>
      </div>
    </div>


    <div class="d-flex align-items-center steps">
      <ng-container *ngFor="let s of headerSteps">
        <div class="d-flex align-items-center me-3">
          <div class="step-circle me-2" [ngClass]="{ active: s.id === currentStep }">
            {{ s.id }}
          </div>
          <div class="small text-muted">{{ s.name }}</div>
        </div>
      </ng-container>
    </div>
  </div>


  <div class="row">
    <!-- ===== C·ªòT TR√ÅI ===== -->
    <div class="col-lg-8 col-md-7 col-sm-12 order-2 order-md-1">
      <!-- ========== TH√îNG TIN LI√äN H·ªÜ ========== -->
      <div class="rules-card">
        <!-- Banner v√†ng nh·∫°t khi ƒëƒÉng nh·∫≠p -->




        <h4 class="rules-title">
          <i class="bi bi-envelope"></i> Li√™n h·ªá ƒë·∫∑t ch·ªó
        </h4>
        <p class="text-muted small mb-3">
          Th√™m li√™n h·ªá ƒë·ªÉ nh·∫≠n x√°c nh·∫≠n ƒë·∫∑t ch·ªó.
        </p>


        <form [formGroup]="contactForm">
          <div class="info-box mb-1">
            <!-- H·ªç t√™n -->
            <div class="mb-3">
              <label for="fullName" class="form-label">H·ªç t√™n*</label>
              <input id="fullName" type="text" formControlName="fullName" class="form-control"
                placeholder="Nh·∫≠p h·ªç t√™n" />
            </div>


            <!-- S·ªë ƒëi·ªán tho·∫°i & Email -->
            <div class="row g-3">
              <div class="col-md-6">
                <label for="phone" class="form-label">S·ªë ƒëi·ªán tho·∫°i*</label>
                <input id="phone" type="text" formControlName="phone" class="form-control"
                  placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" />
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">Email*</label>
                <input id="email" type="text" formControlName="email" class="form-control"
                  placeholder="Nh·∫≠p email (@gmail.com)" />
                <small class="text-muted"
                  *ngIf="contactForm.get('email')?.invalid && contactForm.get('email')?.touched">
                  Email ph·∫£i c√≥ ƒëu√¥i @gmail.com
                </small>
              </div>
            </div>


            <!-- G·∫°ch ch·∫•m -->
            <p class="policy-text small text-muted mt-3"></p>


            <!-- Checkbox -->
            <div *ngIf="isLoggedIn; else notLoggedIn" class="form-check mt-2">
              <div class="login-check mt-3">
                <input class="form-check-input me-2" type="checkbox" id="selfBooking" [checked]="isSelfBooking"
                  (change)="onSelfBookingToggle($event.target.checked)" />
                <label class="form-check-label fw-semibold" for="selfBooking">
                  T√¥i ƒë·∫∑t ph√≤ng cho ch√≠nh m√¨nh
                </label>
              </div>
              <small *ngIf="isLoggedIn" class="text-muted">
                N·∫øu b·∫°n kh√¥ng ƒë·∫∑t cho ch√≠nh m√¨nh, vui l√≤ng nh·∫≠p th√¥ng tin ng∆∞·ªùi nh·∫≠n ch·ªó.
              </small>


            </div>


            <ng-template #notLoggedIn>
              <div class="form-check mt-3">
                <input id="saveInfo" type="checkbox" class="form-check-input" (click)="openLoginPopup($event)" />
                <label for="saveInfo" class="form-check-label">
                  ƒêƒÉng nh·∫≠p ƒë·ªÉ l∆∞u th√¥ng tin c·ªßa b·∫°n (kh√¥ng b·∫Øt bu·ªôc)
                </label>
              </div>
              <p class="mb-1">B·∫°n s·∫Ω nh·∫≠n voucher cho l·∫ßn ƒë·∫∑t ti·∫øp theo.</p>
            </ng-template>
          </div>
        </form>
      </div>
      <!-- ========== H·∫æT TH√îNG TIN LI√äN H·ªÜ ========== -->


      <!-- D·ªäCH V·ª§ ƒêI K√àM -->
      <div class="rules-card">
        <h4 class="rules-title">
          <i class="bi bi-gift"></i> D·ªãch v·ª• ƒëi k√®m
        </h4>

        <!-- D·ªäCH V·ª§ CHUY√äN GIA -->
        <div class="service-group-box" *ngIf="expertServices.length > 0">
          <h5 class="service-group-title">D·ªãch v·ª• chuy√™n gia</h5>
          <div class="service-item d-flex align-items-start mb-3"
            *ngFor="let ex of expertServices | slice:0:(showAllExperts ? expertServices.length : 4)">
            <input type="checkbox" [checked]="ex.selected" (change)="toggleExpertService(ex)"
              class="form-check-input me-2 mt-1" style="width: 18px; height: 18px; cursor: pointer" />
            <div class="service-content flex-grow-1">
              <h6 class="mb-1 fw-semibold">{{ ex.name }}</h6>
              <p class="text-muted small mb-0">{{ ex.description }}</p>
            </div>
            <div class="service-right ms-3">
              <span class="text-primary fw-semibold">{{ ex.price | number }} VND</span>
            </div>
          </div>

          <!-- N√∫t xem th√™m -->
          <div class="text-center mb-3" *ngIf="expertServices.length > 4">
            <button class="btn btn-link btn-sm p-0" (click)="showAllExperts = !showAllExperts">
              {{ showAllExperts ? 'Thu g·ªçn ‚ñ≤' : 'Xem th√™m ‚ñº' }}
            </button>
          </div>
        </div>

        <!-- D·ªäCH V·ª§ THU√ä TH√äM -->
        <div class="service-group-box" *ngIf="extraServices && extraServices.length > 0">
          <h5 class="service-group-title">D·ªãch v·ª• thu√™ th√™m</h5>
          <div class="service-item d-flex align-items-start mb-3"
            *ngFor="let s of extraServices | slice:0:(showAllExtras ? extraServices.length : 4); trackBy: trackByServiceId">
            <input type="checkbox" [checked]="s.selected || false" (change)="toggleExtraService(s, $event)"
              class="form-check-input me-2 mt-1" style="width: 18px; height: 18px; cursor: pointer"
              [id]="'extra-' + s.name" />
            <div class="service-content flex-grow-1">
              <h6 class="mb-1 fw-semibold">{{ s.name || 'D·ªãch v·ª•' }}</h6>
              <p class="text-muted small mb-0">{{ s.description || '' }}</p>
            </div>
            <div class="service-right ms-3 d-flex flex-column align-items-end">
              <span class="text-primary fw-semibold mb-2">{{ (s.price || 0) | number }} VND</span>
              <div class="quantity-control" *ngIf="s.selected">
                <button class="btn btn-primary btn-sm" type="button"
                  (click)="changeExtraQuantity(s, -1, $event); $event.stopPropagation()">
                  ‚àí
                </button>
                <input type="number" class="form-control text-center border-primary" [ngModel]="s.quantity || 1"
                  (ngModelChange)="s.quantity = parseNumber($event); changeExtraQuantity(s, 0, $event)" min="1"
                  max="10" />
                <button class="btn btn-primary btn-sm" type="button" [disabled]="(s.quantity || 1) >= 10"
                  (click)="changeExtraQuantity(s, 1, $event); $event.stopPropagation()">
                  +
                </button>
              </div>
            </div>
          </div>

          <!-- N√∫t xem th√™m -->
          <div class="text-center mb-3" *ngIf="extraServices.length > 4">
            <button class="btn btn-link btn-sm p-0" (click)="showAllExtras = !showAllExtras" type="button">
              {{ showAllExtras ? 'Thu g·ªçn ‚ñ≤' : 'Xem th√™m ‚ñº' }}
            </button>
          </div>
        </div>
      </div>

      <!-- CH√çNH S√ÅCH PH√íNG (Quy ƒë·ªãnh chung) -->
      <div class="rules-card">
        <h4 class="rules-title"><i class="bi bi-shield-check"></i> Ch√≠nh s√°ch ph√≤ng</h4>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-box-arrow-in-right rule-icon"></i>
          <div class="rule-text">
            <h5>Nh·∫≠n ph√≤ng</h5>
            <p>Vui l√≤ng ƒë·∫øn ƒë√∫ng gi·ªù, khuy·∫øn kh√≠ch ƒë·∫øn s·ªõm h∆°n <strong>10 ph√∫t</strong>.</p>
          </div>
        </div>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-clock-history rule-icon"></i>
          <div class="rule-text">
            <h5>Tr·∫£ ph√≤ng tr·ªÖ / Gia h·∫°n</h5>
            <p>Tr·∫£ ph√≤ng tr·ªÖ c√≥ th·ªÉ √°p d·ª•ng ph·ª• ph√≠. Gia h·∫°n s·∫Ω t·∫°o ƒë∆°n m·ªõi v√† √°p d·ª•ng ƒëi·ªÅu ki·ªán nh∆∞ th√¥ng th∆∞·ªùng.</p>
          </div>
        </div>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-x-octagon rule-icon"></i>
          <div class="rule-text">
            <h5>D·ªãch v·ª• k√®m th√™m</h5>
            <p>Kh√¥ng h·ªó tr·ª£ ƒë·∫∑t th√™m "D·ªãch v·ª• chuy√™n gia" trong qu√° tr√¨nh s·ª≠ d·ª•ng.</p>
          </div>
        </div>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-credit-card rule-icon"></i>
          <div class="rule-text">
            <h5>Thanh to√°n</h5>
            <p>Ph·∫£i thanh to√°n to√†n b·ªô h√≥a ƒë∆°n trong v√≤ng 10‚Äì30 ph√∫t t·ª´ l√∫c x√°c nh·∫≠n; qu√° h·∫°n ƒë∆°n s·∫Ω t·ª± h·ªßy.</p>
          </div>
        </div>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-calendar-x rule-icon"></i>
          <div class="rule-text">
            <h5>H·ªßy ƒë·∫∑t ph√≤ng / Thay ƒë·ªïi gi·ªù</h5>
            <p>Ch√≠nh s√°ch c√≥ th·ªÉ thay ƒë·ªïi theo t·ª´ng lo·∫°i ph√≤ng. Vui l√≤ng ki·ªÉm tra ƒëi·ªÅu ki·ªán c·ª• th·ªÉ khi ƒë·∫∑t.</p>
          </div>
        </div>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-person-check rule-icon"></i>
          <div class="rule-text">
            <h5>ƒê·ªô tu·ªïi t·ªëi thi·ªÉu</h5>
            <p>Kh√°ch t·ªëi thi·ªÉu 18 tu·ªïi. Kh√°ch nh·ªè tu·ªïi c·∫ßn c√≥ ng∆∞·ªùi l·ªõn ƒëi c√πng khi nh·∫≠n ph√≤ng.</p>
          </div>
        </div>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-slash-circle rule-icon"></i>
          <div class="rule-text">
            <h5>H√∫t thu·ªëc</h5>
            <p>Kh√¥ng cho ph√©p h√∫t thu·ªëc trong ph√≤ng. Ch·ªâ h√∫t ·ªü khu v·ª±c ch·ªâ ƒë·ªãnh.</p>
          </div>
        </div>
        <div class="rule-item d-flex align-items-start mb-2">
          <i class="bi bi-people rule-icon"></i>
          <div class="rule-text">
            <h5>Ti·ªác t√πng / S·ª± ki·ªán</h5>
            <p>Kh√¥ng cho ph√©p t·ªï ch·ª©c ti·ªác t√πng ho·∫∑c s·ª± ki·ªán.</p>
          </div>
        </div>

        <div class="rule-agree form-check mt-3" id="agreeRulesContainer" [class.required-highlight]="showAgreeRequired">
          <input type="checkbox" id="agreeRules" class="form-check-input" [class.is-invalid]="showAgreeRequired"
            (change)="toggleAgree($event)" />
          <label for="agreeRules" class="form-check-label mt-1">
            T√¥i ƒë√£ ƒë·ªçc v√† ƒë·ªìng √Ω v·ªõi c√°c quy ƒë·ªãnh tr√™n<span class="text-danger required-asterisk">*</span>
          </label>
          <div class="invalid-feedback d-block" *ngIf="showAgreeRequired">
            Vui l√≤ng ƒë·ªìng √Ω v·ªõi c√°c quy ƒë·ªãnh ƒë·ªÉ ti·∫øp t·ª•c
          </div>
        </div>
      </div>
    </div>


    <!-- ===== C·ªòT PH·∫¢I ===== -->
    <div class="col-lg-4 col-md-5 col-sm-12 order-1 order-md-2">
      <!-- TH√îNG TIN PH√íNG -->
      <div class="room-box pb-1">
        <div class="room-badge">
          <i class="bi bi-hand-thumbs-up-fill"></i>
          <span>B·∫°n c√≥ l·ª±a ch·ªçn <strong>tuy·ªát v·ªùi</strong> cho t√¢m h·ªìn c·ªßa b·∫°n</span>
        </div>

        <!-- üü© UPDATED: Hi·ªÉn th·ªã nhi·ªÅu bookings trong c√πng 1 khung (t√°ch ri√™ng) -->
        <ng-container *ngIf="bookings.length > 0; else singleBooking">
          <div *ngFor="let bk of bookings; let i = index" [class]="bookings.length > 1 ? 'mb-3 pb-3' : ''"
            [style.border-bottom]="bookings.length > 1 && i < bookings.length - 1 ? '1px solid #e0e0e0' : 'none'">

            <div class="room-header">
              <h3 class="room-name">{{ bk.roomName || bk.room?.room_name || roomInfo?.room_name || 'Ph√≤ng ch∆°i b√≠ m·∫≠t'
                }}</h3>
              <p class="room-date">
                {{ bk.checkInDate | date: 'EEEE, dd MMMM yyyy' : undefined : 'vi' }}
              </p>
            </div>

            <div class="room-time">
              <div class="time-section">
                <p>Gi·ªù nh·∫≠n</p>
                <h4>{{ bk.checkInTime || '14:00' }}</h4>
              </div>
              <div class="time-mid">
                <span>{{ getBookingHours(bk) }} gi·ªù</span>
              </div>
              <div class="time-section">
                <p>Gi·ªù tr·∫£</p>
                <h4>{{ bk.checkOutTime || '15:00' }}</h4>
              </div>
            </div>

            <div class="room-details">
              <p><i class="bi bi-people-fill"></i> S·ªë l∆∞·ª£ng: {{ bk.room?.range || bk.room?.capacity || roomInfo?.range
                || '2-4 ng∆∞·ªùi' }}</p>
              <p class="free-cancel">
                <i class="bi bi-check2-square"></i>
                <span>
                  Mi·ªÖn ph√≠ h·ªßy tr∆∞·ªõc
                  <strong>{{ bk.cancelBefore | date: 'dd MMMM yyyy' : undefined : 'vi' }}</strong>
                </span>
              </p>
              <p class="changeable">
                <i class="bi bi-arrow-repeat"></i>
                <span>
                  C√≥ th·ªÉ ƒë·ªïi l·ªãch tr∆∞·ªõc
                  <strong>{{ bk.rescheduleBefore | date: 'dd MMMM yyyy' : undefined : 'vi' }}</strong>
                </span>
              </p>
            </div>
          </div>
        </ng-container>

        <ng-template #singleBooking>
          <div class="room-header">
            <h3 class="room-name">{{ roomInfo?.room_name || roomInfo?.roomName || booking?.room?.name || roomInfo?.name
              || 'Ph√≤ng ch∆°i b√≠ m·∫≠t' }}</h3>
            <p class="room-date">
              {{ booking?.checkInDate | date: 'EEEE, dd MMMM yyyy' : undefined : 'vi' }}
            </p>
          </div>

          <div class="room-time">
            <div class="time-section">
              <p>Gi·ªù nh·∫≠n</p>
              <h4>{{ booking?.checkInTime || '14:00' }}</h4>
            </div>
            <div class="time-mid">
              <span>{{ bookingSummary.split(', ')[1] }}</span>
            </div>
            <div class="time-section">
              <p>Gi·ªù tr·∫£</p>
              <h4>{{ booking?.checkOutTime || '15:00' }}</h4>
            </div>
          </div>

          <div class="room-details">
            <p><i class="bi bi-people-fill"></i> S·ªë l∆∞·ª£ng: {{ roomInfo?.range || roomInfo?.capacity || '2-4 ng∆∞·ªùi' }}
            </p>
            <p class="free-cancel">
              <i class="bi bi-check2-square"></i>
              <span>
                Mi·ªÖn ph√≠ h·ªßy tr∆∞·ªõc
                <strong>{{ booking?.cancelBefore | date: 'dd MMMM yyyy' : undefined : 'vi' }}</strong>
              </span>
            </p>
            <p class="changeable">
              <i class="bi bi-arrow-repeat"></i>
              <span>
                C√≥ th·ªÉ ƒë·ªïi l·ªãch tr∆∞·ªõc
                <strong>{{ booking?.rescheduleBefore | date: 'dd MMMM yyyy' : undefined : 'vi' }}</strong>
              </span>
            </p>
          </div>
        </ng-template>
      </div>


      <!-- M√É KHUY·∫æN M√ÉI -->
      <div class="rules-card">
        <h4 class="rules-title"><i class="bi bi-ticket-perforated"></i> M√£ khuy·∫øn m√£i</h4>
        <form (ngSubmit)="applyCoupon()">
          <div class="discount-box">
            <input type="text" [(ngModel)]="promoCode" name="promoCode" placeholder="Nh·∫≠p m√£ khuy·∫øn m√£i"
              class="form-control form-control-sm" (input)="onPromoCodeInput($event)" />
            <button type="submit" class="btn btn-primary">√Åp d·ª•ng</button>
          </div>
          <small *ngIf="discountMessage" [ngClass]="{ 'text-success': isCouponValid, 'text-danger': !isCouponValid }">
            {{ discountMessage }}
          </small>

          <!-- üü® ADD REDEEM: ƒê·ªîI XU (ch·ªâ hi·ªán khi ƒë√£ ƒëƒÉng nh·∫≠p) -->
          <div *ngIf="isLoggedIn"
            class="rewards-toggle mt-3 p-2 px-3 d-flex justify-content-between align-items-center border rounded-3">
            <div class="d-flex align-items-center">
              <i class="bi bi-coin text-warning me-2" style="font-size: 1.2rem"></i>
              <div>
                <strong>ƒê·ªïi 50 Xu</strong>
                <div class="small text-muted">Gi·∫£m 20.000 ƒë cho ƒë∆°n n√†y</div>
              </div>
            </div>
            <div class="form-check form-switch m-0">
              <input class="form-check-input" type="checkbox" id="usePoints" name="usePoints" [checked]="usePoints"
                (change)="togglePoints($any($event.target).checked)" />
            </div>
          </div>
          <small *ngIf="isLoggedIn" class="text-muted d-block mt-1">
            B·∫°n ƒëang c√≥ <strong>{{ availablePoints | number }} Xu</strong>
          </small>
          <small *ngIf="isLoggedIn" class="text-muted d-block">
            L∆∞u √Ω: ƒê·ªïi r·ªìi s·∫Ω kh√¥ng ho√†n Xu.
          </small>
        </form>
      </div>


      <!-- CHI TI·∫æT GI√Å -->
      <div class="rules-card price-card pb-3">
        <div class="d-flex justify-content-between align-items-center" (click)="togglePriceDetails()"
          style="cursor: pointer">
          <h4 class="m-0">
            <i class="bi bi-tag me-2 text-muted" style="font-size: 0.95rem"></i>Chi ti·∫øt gi√°
          </h4>
          <i class="bi" [class.bi-chevron-up]="showPriceDetails" [class.bi-chevron-down]="!showPriceDetails"></i>
        </div>


        <div class="price-details mt-3" *ngIf="showPriceDetails">
          <!-- üü© UPDATED: Gi√° ph√≤ng LU√îN hi·ªÉn th·ªã ·ªü tr√™n c√πng -->
          <!-- Hi·ªÉn th·ªã gi√° t·ª´ nhi·ªÅu bookings (n·∫øu c√≥) -->
          <ng-container *ngIf="bookings.length > 0">
            <!-- Hi·ªÉn th·ªã gi√° t·ª´ng booking ri√™ng -->
            <div *ngFor="let bk of bookings; let i = index" class="mb-2"
              [style.border-bottom]="bookings.length > 1 && i < bookings.length - 1 ? '1px solid #f0f0f0' : 'none'"
              [style.padding-bottom]="bookings.length > 1 && i < bookings.length - 1 ? '12px' : '0'">

              <!-- T√™n ph√≤ng (ch·ªâ hi·ªán n·∫øu c√≥ nhi·ªÅu bookings) -->
              <div *ngIf="bookings.length > 1" class="mb-2">
                <strong class="text-primary">{{ bk.roomName || bk.room?.room_name }}</strong>
                <small class="text-muted d-block">{{ bk.checkInTime }} - {{ bk.checkOutTime }}</small>
              </div>

              <!-- Gi√° ph√≤ng c·ªßa booking n√†y -->
              <div class="price-line d-flex justify-content-between mb-2">
                <span class="text-muted">Gi√° ph√≤ng{{ bookings.length > 1 ? ' (' + getBookingHours(bk) + ' gi·ªù)' : ''
                  }}</span>
                <span>{{ bk.basePrice | number }} VND</span>
              </div>
            </div>
          </ng-container>

          <!-- Fallback: Hi·ªÉn th·ªã gi√° ph√≤ng (n·∫øu kh√¥ng c√≥ bookings) -->
          <ng-container *ngIf="bookings.length === 0">
            <div class="price-line d-flex justify-content-between mb-2">
              <span class="text-muted">Gi√° ph√≤ng</span>
              <span>{{ basePrice | number }} VND</span>
            </div>
          </ng-container>

          <!-- üü© UPDATED: D·ªãch v·ª• hi·ªÉn th·ªã SAU gi√° ph√≤ng -->
          <!-- D·ªãch v·ª• chuy√™n gia ƒë∆∞·ª£c ch·ªçn (t·ª´ UI) -->
          <ng-container *ngIf="selectedExpertServices.length > 0">
            <div class="price-line d-flex justify-content-between mb-2" *ngFor="let s of selectedExpertServices">
              <span class="text-muted">{{ s.name }}</span>
              <span>{{ s.price | number }} VND</span>
            </div>
          </ng-container>

          <!-- D·ªãch v·ª• thu√™ th√™m ƒë∆∞·ª£c ch·ªçn (t·ª´ UI) -->
          <ng-container *ngIf="selectedExtraServices.length > 0">
            <div class="price-line d-flex justify-content-between mb-2" *ngFor="let s of selectedExtraServices">
              <span class="text-muted">{{ s.name }} x{{ s.quantity || 1 }}</span>
              <span>{{ (s.price * (s.quantity || 1)) | number }} VND</span>
            </div>
          </ng-container>

          <!-- M√£ gi·∫£m gi√° (√°p d·ª•ng cho t·ªïng) -->
          <div class="price-line d-flex justify-content-between mb-2" *ngIf="discountValue > 0">
            <span class="text-muted">M√£ gi·∫£m gi√°</span>
            <span class="text-success">-{{ discountValue | number }} VND</span>
          </div>

          <!-- üü® ADDED: Hi·ªÉn th·ªã gi·∫£m gi√° t·ª´ Redeem Xu -->
          <div class="price-line d-flex justify-content-between mb-2" *ngIf="usePoints && pointsDiscountValue > 0">
            <span class="text-muted">ƒê·ªïi 50 Xu</span>
            <span class="text-success">-{{ pointsDiscountValue | number }} VND</span>
          </div>
        </div>


        <div class="total-price d-flex justify-content-between align-items-center mt-3 pt-2 border-top">
          <div>
            <h5 class="m-0">T·ªïng c·ªông</h5>
            <small class="text-muted">{{ bookingSummary }}</small>
          </div>
          <div class="text-end">
            <span class="old-price text-decoration-line-through text-muted small"
              *ngIf="originalPrice && totalPrice < originalPrice">{{ originalPrice | number }} VND</span>
            <h5 class="text-primary m-0">{{ totalPrice | number }} VND</h5>
            <!-- üü® ADDED: Hi·ªÉn th·ªã khi Redeem √°p d·ª•ng th√†nh c√¥ng -->
            <small *ngIf="usePoints && pointsDiscountValue > 0" class="text-success d-block">ƒê√£ tr·ª´ 20.000 ƒë (50
              Xu)</small>
          </div>
        </div>


        <button class="btn btn-primary w-100 mt-3 pay-btn" (click)="confirmBooking()">Ti·∫øp t·ª•c</button>


        <small class="text-muted d-block mt-2 policy-text">
          B·∫±ng c√°ch thanh to√°n, b·∫°n ƒë·ªìng √Ω v·ªõi
          <a class="policy-link" routerLink="/policy/termsofuse" target="_blank" rel="noopener noreferrer">ƒêi·ªÅu kho·∫£n &amp; ƒêi·ªÅu
            ki·ªán</a> v√†
          <a class="policy-link" routerLink="/policy/operating" target="_blank" rel="noopener noreferrer">Ch√≠nh s√°ch ho·∫°t
            ƒë·ªông</a>.
        </small>


        <div class="rewards-row pt-1">
          <div class="reward-item d-flex align-items-center">
            <span class="icon rounded-circle d-inline-flex align-items-center justify-content-center me-2"
              style="background: #fff6e6; width: 30px; height: 30px">
              <i class="bi bi-coin" style="color: #f59e0b; font-size: 1.05rem"></i>
            </span>
            <div><strong>Ki·∫øm {{ rewardPoints | number }} Xu</strong></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>