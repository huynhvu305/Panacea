<!-- H1 for SEO -->
<h1 class="sr-only">Panacea - A medicine from the stars - Không gian trị liệu và chữa lành tâm hồn</h1>

<!-- HOME VIDEO -->
<div class="video-section">
  <div class="video-wrapper">
    <video class="hero-video" [poster]="videoPoster" [src]="videoSrc" autoplay muted loop playsinline preload="auto"
      fetchpriority="high" [attr.muted]="true" #heroVideo
      title="Video giới thiệu Panacea - Không gian trị liệu và chữa lành tâm hồn">
      Trình duyệt của bạn không hỗ trợ video.
    </video>
  </div>
</div>

<!-- SEARCH BAR -->
<div class="sb-banner">
  <div class="container">
    <!-- Tabs -->
    <div class="sb-tabs">
      <button class="sb-tab" [class.active]="isActive('book')" (click)="setTab('book')">
        <i class="bi bi-calendar2-check"></i> Đặt dịch vụ
      </button>
      <a routerLink="/exchange-landing" class="sb-tab ghost" [class.active]="isActive('guide')">
        <i class="bi bi-journal-richtext"></i> Xem ưu đãi
      </a>
    </div>

    <!-- Card -->
    <div class="sb-card" *ngIf="activeTab==='book'">
      <!-- Khu vườn - Button chips -->
      <div class="sb-row sb-zones">
        <label class="sb-label">Khu vườn</label>
        <div class="sb-chips">
          <button *ngFor="let z of zones" class="sb-chip" [class.active]="zone===z.key" (click)="selectZone(z.key)">
            {{ getZoneButtonLabel(z) }}
          </button>
        </div>
      </div>

      <!-- Search Bar lớn -->
      <div class="sb-search-container">
        <!-- Price - Min Max -->
        <div class="sb-search-field-wrapper">
          <label class="sb-search-label">Khoảng giá</label>
          <div class="sb-search-field sb-price-range">
            <div class="sb-price-controls">
              <div class="sb-control sb-price-left">
                <i class="bi bi-cash-coin"></i>
                <input type="text" class="sb-input" placeholder="Từ" [(ngModel)]="selectedMinPrice"
                  (input)="onPriceInput($event, 'min')" (blur)="onPriceBlur($event, 'min')"
                  (keydown)="onPriceKeyDown($event, 'min')" />
              </div>
              <span class="sb-price-separator">–</span>
              <div class="sb-control sb-price-right">
                <input type="text" class="sb-input" placeholder="Đến" [(ngModel)]="selectedMaxPrice"
                  (input)="onPriceInput($event, 'max')" (blur)="onPriceBlur($event, 'max')"
                  (keydown)="onPriceKeyDown($event, 'max')" />
              </div>
            </div>
          </div>
        </div>

        <!-- Date -->
        <div class="sb-search-field-wrapper">
          <label class="sb-search-label">Ngày</label>
          <div class="sb-search-field">
            <div class="sb-control">
              <i class="bi bi-calendar3 calendar-icon" (click)="openDatePicker()" title="Chọn ngày"></i>
              <input type="date" #dateInput class="sb-input" [(ngModel)]="date" id="date-input" />
            </div>
          </div>
        </div>

        <!-- Capacity -->
        <div class="sb-search-field-wrapper">
          <label class="sb-search-label">Sức chứa</label>
          <div class="sb-search-field">
            <div class="sb-control">
              <i class="bi bi-people"></i>
              <select class="sb-select" [(ngModel)]="guestCountFilter">
                <option value="">Tất cả</option>
                <option value="2">1-2 người</option>
                <option value="5">3-5 người</option>
                <option value="10">6-10 người</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Search Button -->
        <div class="sb-search-button-wrapper">
          <button class="sb-search" (click)="onSearch()">
            <i class="bi bi-search"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Guide tab placeholder -->
    <div class="sb-card sb-guide" *ngIf="activeTab==='guide'">
      <p><b>Cẩm nang Panacea</b> — mẹo thư giãn, bài tập thở, checklist chăm sóc bản thân, và thông tin từng khu vườn.
        (Section này bạn có thể gắn router sau.)</p>
    </div>
  </div>
</div>

<!-- GARDENS - Lazy Load Section -->
<div #gardensSection data-section="gardens" class="scroll-reveal" style="min-height: 100px;">
  <!-- Placeholder/Skeleton khi chưa load -->
  <section class="gd container" *ngIf="!gardensLoaded">
    <header class="gd-head">
      <h2 class="gd-title">Bốn Khu Vườn</h2>
      <p class="gd-sub">Mỗi khu vườn là một hành trình chữa lành riêng</p>
    </header>
    <div class="gd-grid">
      <article class="gd-card" *ngFor="let i of [1,2,3,4]">
        <div class="gd-cover">
          <div class="gd-placeholder"></div>
        </div>
        <div class="gd-body">
          <div class="gd-badge" style="opacity: 0.5;">
            <div style="width: 34px; height: 34px; border-radius: 50%; background: #e0e0e0;"></div>
            <div style="flex: 1; height: 20px; background: #e0e0e0; border-radius: 4px;"></div>
          </div>
        </div>
      </article>
    </div>
  </section>

  <!-- Nội dung thực khi đã load -->
  <section class="gd container" *ngIf="gardensLoaded">
    <header class="gd-head">
      <h2 class="gd-title">Bốn Khu Vườn</h2>
      <p class="gd-sub">Mỗi khu vườn là một hành trình chữa lành riêng</p>
    </header>

    <div class="gd-grid">
      <article class="gd-card" *ngFor="let g of gardens; trackBy: trackByKey">
        <!-- Ảnh cover -->
        <div class="gd-cover" [style.--img]="'url('+ g.cover +')'">
          <!-- vignette/overlay chỉ nhẹ để hài hoà, không làm tối -->
          <div class="gd-vignette"></div>
        </div>

        <!-- Nội dung -->
        <div class="gd-body">
          <div class="gd-badge">
            <span class="gd-icon" [ngClass]="g.key"></span>
            <div class="gd-text">
              <b>{{ g.title }}</b>
              <small>{{ g.subtitle }}</small>
            </div>
          </div>

          <p class="gd-desc">{{ g.desc }}</p>

          <!-- CTA cam (quan trọng) -->
          <a class="gd-cta" href="#" (click)="goToRoomList(g, $event)">
            Xem phòng <i class="bi bi-arrow-right-short"></i>
          </a>
        </div>
      </article>
    </div>
  </section>
</div>

<!-- TWO COLUMN INTRO SECTION -->
<section #introSection class="intro-hero-section scroll-reveal">
  <div class="intro-container">
    <!-- Column 1: Text & Stats -->
    <div class="intro-content">
      <h1 class="intro-headline-1">Find Your Balance. Find Your Panacea.</h1>
      <h2 class="intro-headline-2">Tái Tạo Năng Lượng. Phục Hồi Tâm Trí.</h2>

      <div class="intro-stats">
        <div class="stat-item">
          <div class="stat-number">{{ formatStatValue(0) }}</div>
          <div class="stat-label">Khu Vườn Trị Liệu</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">{{ formatStatValue(1) }}</div>
          <div class="stat-label">Dịch Vụ Đa Dạng</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">{{ formatStatValue(2) }}</div>
          <div class="stat-label">Chuyên Gia Hỗ Trợ</div>
        </div>
      </div>
    </div>

    <!-- Column 2: Banner Image -->
    <div class="intro-banner">
      <img src="../../assets/images/bannerhomepage.webp" alt="Panacea Banner - Không gian trị liệu và chữa lành tâm hồn"
        title="Banner Panacea - Find Your Balance. Find Your Panacea. Tái Tạo Năng Lượng. Phục Hồi Tâm Trí."
        class="banner-image-placeholder" loading="lazy">
    </div>
  </div>
</section>

<!-- REASONS -->
<section class="reasons container scroll-reveal">
  <h2 class="reasons-title">LÝ DO CHỌN PANACEA?</h2>

  <div class="reasons-grid">
    <!-- 1. Giá/ưu đãi minh bạch -->
    <article class="reason-card">
      <div class="card-icon i-price" aria-hidden="true"></div>
      <div class="card-content">
        <h3>Giá & ưu đãi minh bạch</h3>
        <p>Niêm yết rõ ràng, nhiều combo tiết kiệm. Không phí ẩn, tính đúng – nhận đủ.</p>
      </div>
    </article>

    <!-- 2. Tích điểm Priority -->
    <article class="reason-card">
      <div class="card-icon i-priority" aria-hidden="true"></div>
      <div class="card-content">
        <h3>Tích điểm Priority</h3>
        <p>1.000&nbsp;VNĐ = 1 điểm; 500 điểm = 1 sao. Lên hạng nhận nhân điểm, voucher & đặc quyền.</p>
      </div>
    </article>

    <!-- 3. Đặt chỗ/đổi lịch linh hoạt -->
    <article class="reason-card">
      <div class="card-icon i-flex" aria-hidden="true"></div>
      <div class="card-content">
        <h3>Đặt chỗ linh hoạt</h3>
        <p>Đổi giờ dễ dàng theo chính sách linh hoạt — thao tác vài bước là xong.</p>
      </div>
    </article>
  </div>
</section>

<!-- PRIORITY - Lazy Load Section -->
<div #prioritySection data-section="priority" class="scroll-reveal" style="min-height: 100px; position: relative;">
  <!-- Placeholder khi chưa load -->
  <section class="priority-section" *ngIf="!priorityLoaded">
    <div class="container">
      <div class="priority-intro">
        <h2 class="priority-title">PANACEA PRIORITY</h2>
        <div style="height: 60px; background: #e0e0e0; border-radius: 8px; margin: 20px 0;"></div>
      </div>
      <div class="priority-cards">
        <div *ngFor="let i of [1,2,3,4,5]"
          style="height: 300px; background: #f0f0f0; border-radius: 12px; margin: 10px;"></div>
      </div>
    </div>
  </section>

  <!-- Nội dung thực khi đã load -->
  <section class="priority-section" *ngIf="priorityLoaded">
    <div class="container">
      <!-- INTRO -->
      <div class="priority-intro">
        <h2 class="priority-title">PANACEA PRIORITY</h2>
        <p class="priority-description">
          Tích điểm – lên hạng – mở khóa đặc quyền. <b>1.000&nbsp;VNĐ = 1 điểm</b>, <b>500 điểm = 1 sao</b>.
          Quyền lợi gồm ưu đãi giá dịch vụ, voucher hằng năm, quà sinh nhật và đặc quyền VIP.
        </p>
      </div>

      <!-- CARDS -->
      <div class="priority-cards">
        <!-- BRONZE -->
        <div class="priority-card bronze">
          <div class="shine-container"></div>
          <img src="assets/images/dong.webp" alt="Biểu tượng Bronze Priority - Hạng đồng Panacea"
            title="Biểu tượng Bronze Priority - Hạng đồng Panacea. Quyền lợi: Voucher chào mừng -10%"
            class="priority-icon" loading="lazy">
          <h4>BRONZE PRIORITY</h4>
          <div class="card-content">
            <p class="requirement"><b>Khi đăng ký tài khoản Panacea</b></p>
            <p class="meta">Quyền lợi độc quyền:</p>
            <div class="benefits-row">
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Voucher chào mừng <b>-10%</b></span>
              </div>
            </div>
          </div>
        </div>

        <!-- SILVER -->
        <div class="priority-card silver">
          <div class="shine-container"></div>
          <img src="assets/images/bac.webp" alt="Biểu tượng Silver Priority - Hạng bạc Panacea"
            title="Biểu tượng Silver Priority - Hạng bạc Panacea. Quyền lợi: Nhân 1.2× điểm, Giảm 5% giá dịch vụ mọi ngày thường"
            class="priority-icon" loading="lazy">
          <h4>SILVER PRIORITY</h4>
          <div class="card-content">
            <p class="requirement"><b>Tích đủ 5 sao</b></p>
            <p class="meta">Quyền lợi độc quyền:</p>
            <div class="benefits-row">
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Nhân <b>1.2×</b> điểm mỗi giao dịch</span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Giảm <b>5%</b> giá dịch vụ <b>mọi ngày thường</b></span>
              </div>
            </div>
          </div>
        </div>

        <!-- GOLD -->
        <div class="priority-card gold">
          <div class="shine-container"></div>
          <img src="assets/images/vang.webp" alt="Biểu tượng Gold Priority - Hạng vàng Panacea"
            title="Biểu tượng Gold Priority - Hạng vàng Panacea. Quyền lợi: Nhân 1.5× điểm, Giảm 10% toàn bộ dịch vụ, Voucher 200.000đ mỗi năm"
            class="priority-icon" loading="lazy">
          <h4>GOLD PRIORITY</h4>
          <div class="card-content">
            <p class="requirement"><b>Tích đủ 20 sao</b></p>
            <p class="meta">Quyền lợi độc quyền:</p>
            <div class="benefits-row">
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Nhân <b>1.5×</b> điểm</span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span><b>-10%</b> toàn bộ dịch vụ <span>(kể cả cuối tuần, trừ ngày lễ)</span></span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Voucher <b>200.000đ</b> mỗi năm</span>
              </div>
            </div>
          </div>
        </div>

        <!-- PLATINUM -->
        <div class="priority-card platinum">
          <div class="shine-container"></div>
          <img src="assets/images/bachkim.webp" alt="Biểu tượng Platinum Priority - Hạng bạch kim Panacea"
            title="Biểu tượng Platinum Priority - Hạng bạch kim Panacea. Quyền lợi: Nhân 1.8× điểm, Giảm 15% dịch vụ, Voucher 500.000đ mỗi năm, Quà sinh nhật đặc biệt"
            class="priority-icon" loading="lazy">
          <h4>PLATINUM PRIORITY</h4>
          <div class="card-content">
            <p class="requirement"><b>Tích đủ 50 sao</b></p>
            <p class="meta">Quyền lợi độc quyền:</p>
            <div class="benefits-row">
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Nhân <b>1.8×</b> điểm</span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span><b>-15%</b> dịch vụ & đi kèm <span>(kể cả cuối tuần, trừ ngày lễ)</span></span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Voucher <b>500.000đ</b> mỗi năm</span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Quà sinh nhật <b>đặc biệt</b></span>
              </div>
            </div>
          </div>
        </div>

        <!-- DIAMOND -->
        <div class="priority-card diamond">
          <div class="shine-container"></div>
          <img src="assets/images/kimcuong.webp" alt="Biểu tượng Diamond Priority - Hạng kim cương Panacea"
            title="Biểu tượng Diamond Priority - Hạng kim cương Panacea. Quyền lợi: Nhân 2× điểm, Giảm 20% dịch vụ, Voucher 1.000.000đ mỗi năm, Quà sinh nhật cao cấp"
            class="priority-icon" loading="lazy">
          <h4>DIAMOND PRIORITY</h4>
          <div class="card-content">
            <p class="requirement"><b>Tích đủ 100 sao</b></p>
            <p class="meta">Quyền lợi độc quyền:</p>
            <div class="benefits-row">
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Nhân <b>2×</b> điểm</span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span><b>-15%</b> dịch vụ & đi kèm <span>(mọi ngày trong năm)</span></span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Voucher <b>1.000.000đ</b> mỗi năm</span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Quà sinh nhật <b>đặc biệt</b></span>
              </div>
              <div class="benefit">
                <i class="bi bi-check2-circle"></i>
                <span>Đi cùng <b>1 người</b> miễn phí mỗi tháng</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CTA -->
      <div class="priority-button-container">
        <a routerLink="/support/star" class="btn btn-lg rounded-4 btn-join">
          <i class="bi bi-stars"></i> THAM GIA PANACEA PRIORITY
        </a>
      </div>
    </div>
  </section>
</div>

<!-- FEEDBACK - Lazy Load Section -->
<div #feedbackSection data-section="feedback" class="scroll-reveal" style="min-height: 100px; position: relative;">
  <!-- Placeholder khi chưa load -->
  <section class="fb-section" *ngIf="!feedbackLoaded">
    <div class="container">
      <div class="fb-header">
        <h2 class="fb-title">PHẢN HỒI TỪ KHÁCH HÀNG</h2>
        <div style="height: 40px; background: #e0e0e0; border-radius: 8px; margin: 20px 0;"></div>
      </div>
      <div class="fb-grid">
        <div *ngFor="let i of [1,2,3]" style="height: 200px; background: #f0f0f0; border-radius: 12px; margin: 10px;">
        </div>
      </div>
    </div>
  </section>

  <!-- Nội dung thực khi đã load -->
  <section class="fb-section" *ngIf="feedbackLoaded">
    <div class="container">
      <div class="fb-header">
        <h2 class="fb-title">PHẢN HỒI TỪ KHÁCH HÀNG</h2>
        <p class="fb-sub">Những phản hồi thật từ khách hàng – giúp Panacea tốt hơn mỗi ngày.</p>
      </div>

      <div class="fb-grid">
        <div class="fb-card" *ngFor="let fb of feedbackItems">
          <div class="fb-badge-top">
            <span class="fb-badge" [ngClass]="getTierClass(fb.tier)" *ngIf="fb.tier">
              {{ fb.tier }}
            </span>
          </div>

          <div class="fb-info">
            <div class="fb-avatar">{{ getInitial(fb.name) }}</div>
            <div class="fb-info-text">
              <div class="fb-name">{{ fb.name }}</div>
              <div class="fb-role">{{ fb.role || 'Khách hàng' }}</div>
            </div>
          </div>

          <div class="fb-stars" aria-label="rating">
            <i class="bi bi-star-fill" *ngFor="let _ of getStars(fb.rating)"></i>
          </div>

          <p class="fb-text">{{ fb.text }}</p>
        </div>
      </div>
    </div>
  </section>
</div>